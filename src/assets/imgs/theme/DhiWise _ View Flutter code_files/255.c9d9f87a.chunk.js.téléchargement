(this.webpackJsonpdhiwise=this.webpackJsonpdhiwise||[]).push([[255],{3033:function(y,R,n){(function(M,l){y.exports=l()})(this,function(){"use strict";return function(M,l){l.prototype.isSameOrAfter=function(g,v){return this.isSame(g,v)||this.isAfter(g,v)}}})},3887:function(y,R,n){"use strict";n.r(R);var M=n(0),l=n.n(M),g=n(330),v=n.n(g),i=n(46),p=n(383),st=n.n(p),_=n(26),x=n(76),A=n.n(x),B=n(114),ct=n.n(B),Y=n(115),J=n.n(Y),N=n(6),dt=n.n(N),u=n(4),s=n(28),X=n(97),c=n(11),z=n(264),Q=n(183),V=n(31),W=n(59),K=n(2),G=n(608),$=n(69),Z=n(284),j=(f,o,d)=>new Promise((h,O)=>{var I=t=>{try{m(d.next(t))}catch(P){O(P)}},T=t=>{try{m(d.throw(t))}catch(P){O(P)}},m=t=>t.done?h(t.value):Promise.resolve(t.value).then(I,T);m((d=d.apply(f,o)).next())});const w=n(3033);A.a.extend(w);function k({component:f,path:o,moduleId:d,action:h="VIEW",isOnboardingUrl:O=!1}){var I;const T=Object(_.e)(),m=Object(i.g)(),{userData:t}=Object(X.a)(),P=Object(_.f)(e=>e.auth.userType||0),q=Object(_.f)(e=>e.auth.expireTrialPlan||!1),E=c.a.get(u.D),tt=Object(_.f)(e=>e.auth.userPermission||[]),et=Object(_.f)(e=>e.auth.isWorkspaceDeleted||!1),nt=Object(_.f)(e=>e.auth.defaultRedirectUrl),[at,lt]=Object(V.c)(),{currentApplicationCode:U,currentApplicationId:ot}=at,a=Object(i.h)(),L=new URLSearchParams(a.search),S=L.get("figmaRedirectPage"),{hasFeature:F}=Object(B.useFlagsmith)(),C=F(W.NON_TECH_SPECIFIC_FLAGS.FIGMA_PLUGIN_ONBOARDING),it=()=>{setTimeout(()=>{var e;o.includes(G.a)&&!F((e=W.FLAG_SMITH_FEATURES[U])==null?void 0:e.REACT_ADMIN_PANEL)&&m.push("*")},0)},rt=()=>j(this,null,function*(){try{yield J.a.identify(t==null?void 0:t.email,{email:t==null?void 0:t.email})}catch(e){console.warn("flagsmith")}it()});if(l.a.useEffect(()=>j(this,null,function*(){U===K.b.reactAdmin&&(yield rt())}),[t==null?void 0:t.email]),l.a.useEffect(()=>{if(!(t!=null&&t.isInternalUser))try{}catch(e){console.error("Error while setting userflow user id",e)}},[t]),l.a.useEffect(()=>{if(t!=null&&t.email)try{window.clarity("identify",t==null?void 0:t.email),window.clarity("set","email",t==null?void 0:t.email)}catch(e){console.error("Error while setting clarity user id",e)}},[t==null?void 0:t.email]),l.a.useEffect(()=>{var e,r,b,H;(r=(e=document.getElementsByTagName("flt-glass-pane"))==null?void 0:e[0])!=null&&r.style&&(document.getElementsByTagName("flt-glass-pane")[0].style.display="none"),(H=(b=document.getElementsByTagName("flutter-view"))==null?void 0:b[0])!=null&&H.style&&(document.getElementsByTagName("flutter-view")[0].style.display="none")},[o]),Object(N.last)(o.split("/"))===":appId"&&!ot)return l.a.createElement(i.a,{to:"/dashboard"});if(U!==K.b.reactAdmin&&o.includes(G.a))return l.a.createElement(i.a,{to:"*"});if(o==="/figma-authentication"&&!E&&c.a.set("FIGMA_PLUGIN_REDIRECTION",(a==null?void 0:a.pathname)+(a==null?void 0:a.search)),o==="/figmaPluginCode"&&!E&&c.a.set("FIGMA_PLUGIN_REDIRECTION",(a==null?void 0:a.pathname)+(a==null?void 0:a.search)),o==="/figmaPluginApp"&&!E&&c.a.set(u.j,(a==null?void 0:a.pathname)+(a==null?void 0:a.search)),o==="/open-code-view"&&!E&&c.a.set(u.c,(a==null?void 0:a.pathname)+(a==null?void 0:a.search)),o==="/account/figma-list"&&!E&&c.a.set("FIGMA_LIST_REDIRECTION","/account/figma-list"),o==="/shopify-connect"&&!E&&c.a.set("SHOPIFY_AUTH_REDIRECTION_URL",(a==null?void 0:a.pathname)+(a==null?void 0:a.search)),["/select-screen-app","/template-category-app"].includes(o)&&!E){c.a.set(u.G,a==null?void 0:a.pathname);const e=a.search,r=L.get("ref");(e.includes("utm_source")||e.includes("utm_medium")||e.includes("utm_campaign"))&&c.a.set(u.F,e),r&&c.a.set(u.z,r)}if(!E)return["signin","sign-up"].includes(S)?l.a.createElement(i.a,{to:`/${S}`}):l.a.createElement(i.a,{to:"/sign-up"});c.a.get("TOKEN_EXPIRY")&&A()().isSameOrAfter(A()(c.a.get("TOKEN_EXPIRY")))&&(T({type:"LOGOUT"}),lt(Object($.d)())),console.log("here, protected route");const D=Object(Z.a)(L);if(console.log("connectedWithIntelliJUrl",D),o!=="/connected-with-wisegpt"&&(D==null?void 0:D.length))return l.a.createElement(i.a,{to:D});if((t==null?void 0:t._id)&&(t==null?void 0:t.step)&&(t==null?void 0:t.step)<=s.g.FIGMA_PLUGIN_AUTH_REDIRECT.id&&!O){const e=v()(Object.values(s.g),{id:t.step});let r=e!=null&&e.link?e==null?void 0:e.link:"/dashboard";return console.log("condition with < 9"),!e&&s.g.ONBOARDING.id<=(t==null?void 0:t.step)<s.g.SELECT_TECHNOLOGY.id&&(r="/onboarding"),r==="/dashboard"&&(r=nt),(t==null?void 0:t.step)===s.g.FIGMA_PLUGIN_AUTH_REDIRECT.id&&c.a.get("FIGMA_PLUGIN_REDIRECTION")&&(r=c.a.get("FIGMA_PLUGIN_REDIRECTION")),(t==null?void 0:t.step)===s.g.FIGMA_PLUGIN_AUTH_REDIRECT.id&&a.search.includes("figmaPluginCode=true")&&(r=a.pathname+a.search),(t==null?void 0:t.step)===s.g.FIGMA_PLUGIN_AUTH_REDIRECT.id&&r==="/dashboard"&&(r="/onboarding"),C&&o==="/figma-authentication"&&s.g.ONBOARDING.id<=(t==null?void 0:t.step)&&(r="/onboarding"),l.a.createElement(i.a,{to:r})}if(C&&o==="/figma-authentication"&&s.g.ONBOARDING.id<=(t==null?void 0:t.step))return l.a.createElement(i.a,{to:"/onboarding"});if(C&&o==="/figmaPluginApp"&&s.g.ONBOARDING.id<=(t==null?void 0:t.step))return l.a.createElement(i.a,{to:"/onboarding"});if(o==="/onboarding"&&(t==null?void 0:t.step)===s.g.FINAL.id)return l.a.createElement(i.a,{to:"/dashboard"});if((t==null?void 0:t.step)===s.g.SELECT_TECHNOLOGY.id&&!O)return l.a.createElement(i.a,{to:"/onboarding"});if(q&&!s.a.includes(o))return P===s.f.PRIMARY?l.a.createElement(i.a,{to:"/upgrade-your-plan"}):l.a.createElement(i.a,{to:"/developer-plan"});if(d){const e=(I=tt.find(r=>r.module===d))==null?void 0:I.actions;if(!e||!e[h])return t!=null&&t._id?l.a.createElement(i.a,{to:"*"}):(localStorage.clear(),l.a.createElement(i.a,{to:"/signIn"}))}return et&&["/new","/technology-step","/technology-select"].includes(o)?l.a.createElement(i.a,{to:"*"}):!!(t!=null&&t._id)&&!!E?(console.log("redect why?",o),l.a.createElement(i.b,{component:f,path:o})):l.a.createElement(i.a,{to:"/sign-up"})}R.default=Object(p.withErrorBoundary)(k,{FallbackComponent:z.a,onError(f,o){const d={errorLog:f.toString(),componentStack:o==null?void 0:o.componentStack,route:window.location.pathname};Object(Q.a)(d)},resetKeys:[Math.random()]})}}]);
