<app-header></app-header>
<main class="main">
  <div class="page-header breadcrumb-wrap">
    <div class="container">
      <div class="breadcrumb">
        <a><i class="fi-rs-home mr-5"></i>Accueil</a>
        <span></span>
        <a [href]="'/ads-category/' + adDetail.category?.id">{{
          adDetail.category?.name
        }}</a>
        <span></span> {{ adDetail.title }}
      </div>
    </div>
  </div>
  <div class="container mb-30">
    <div class="row">
      <div class="col-xl-11 col-lg-12 m-auto">
        <div class="row">
          <div class="col-xl-8">
            <div class="product-detail accordion-detail">
              <div class="row mb-30 mt-30">
                <div
                  class="col-sm-12 col-xs-12 mb-md-0 mb-sm-5"
                  [ngClass]="{ 'single-image': adDetail.medias?.length === 1 }"
                  *ngIf="!isScreenphone && adDetail.medias?.length == 1"
                >
                  <div class="detail-gallery">
                    <!-- MAIN SLIDES -->

                    <!-- Photo Grid -->
                    <div class="row1">
                      <div
                        class="column1"
                        *ngFor="let media of adDetail.medias"
                      >
                        <p-image
                          *ngIf="media.url"
                          [src]="media.url"
                          alt="product image"
                          class="img-fluid first"
                          width="100%"
                          [preview]="true"
                        ></p-image>
                      </div>
                    </div>
                  </div>

                  <!-- End Gallery -->
                </div>
                <div
                  class="col-sm-12 col-xs-12 mb-md-0 mb-sm-5"
                  [ngClass]="{ 'single-image': adDetail.medias?.length === 1 }"
                  *ngIf="!isScreenphone && adDetail.medias?.length == 2"
                >
                  <div class="image-grid">
                    <ng-container
                      *ngFor="let media of adDetail.medias; let i = index"
                    >
                      <div class="image-item" *ngIf="media.url">
                        <p-image
                          [src]="media.url"
                          alt="product image"
                          class="img-fluid"
                          [class.left-border-radius]="i % 2 === 0"
                          [class.right-border-radius]="i % 2 !== 0"
                          [preview]="true"
                        ></p-image>
                      </div>
                    </ng-container>
                  </div>

                  <!-- End Gallery -->
                </div>
                <div
                  class="col-sm-12 col-xs-12 mb-md-0 mb-sm-5"
                  [ngClass]="{ 'single-image': adDetail.medias?.length === 1 }"
                  *ngIf="!isScreenphone && adDetail.medias?.length == 3"
                >
                  <div class="image-grid">
                    <div class="image-item full-height">
                      <ng-container *ngIf="adDetail.medias.length > 0">
                        <p-image
                          [src]="adDetail.medias[0].url"
                          alt="product image"
                          class="img-fluid"
                          [preview]="true"
                        ></p-image>
                      </ng-container>
                    </div>
                    <ng-container
                      *ngFor="
                        let media of adDetail.medias.slice(1, 3);
                        let i = index
                      "
                    >
                      <div
                        class="image-item half-height"
                        [ngClass]="{ 'right-border-radius': i === 1 }"
                      >
                        <p-image
                          [src]="media.url"
                          alt="product image"
                          class="img-fluid"
                          [preview]="true"
                        ></p-image>
                      </div>
                    </ng-container>
                  </div>

                  <!-- End Gallery -->
                </div>
                <div
                  class="col-sm-12 col-xs-12 mb-md-0 mb-sm-5"
                  [ngClass]="{ 'single-image': adDetail.medias?.length === 1 }"
                  *ngIf="isScreenphone"
                >
                  <div *ngIf="adDetail.medias?.length === 1">
                    <div
                      class="detail-gallery"
                      *ngFor="let media of adDetail.medias"
                    >
                      <!-- MAIN SLIDES -->
                      <p-image
                        *ngIf="media.url"
                        [src]="media.url"
                        alt="product image"
                        class="img-fluid slider"
                        width="100%"
                        [preview]="true"
                      ></p-image>
                    </div>
                  </div>

                  <div *ngIf="adDetail.medias?.length > 1">
                    <p-galleria
                      [value]="adDetail.medias"
                      [showThumbnails]="false"
                      [showItemNavigators]="true"
                      [showIndicators]="false"
                      [numVisible]="6"
                      [autoPlay]="false"
                      [circular]="true"
                      [responsiveOptions]="responsiveOptions"
                      containerClass="custom-galleria"
                    >
                      <ng-template pTemplate="item" let-media>
                        <p-image
                          *ngIf="media.url"
                          [src]="media.url"
                          alt="product image"
                          class="img-fluid slider"
                          width="100%"
                          [preview]="true"
                        ></p-image>
                      </ng-template>
                    </p-galleria>
                  </div>
                </div>
              </div>

              <h4 class="style-1 mb-10">
                {{ adDetail.title }}
              </h4>
              <h6 class="style-1 mb-10">{{ adDetail.price }} DH</h6>
              <div class="mb-30">
                <span class="font-small text-muted"
                  >{{ getRelativeTime(adDetail.created_at) }}
                </span>
              </div>
              <div class="product-info">
                <div class="tab-style3">
                  <ul class="nav nav-tabs text-uppercase">
                    <li class="nav-item">
                      <a
                        class="nav-link active"
                        id="Description-tab"
                        data-bs-toggle="tab"
                        href="#Description"
                        >Description</a
                      >
                    </li>
                    <li class="nav-item">
                      <a
                        class="nav-link"
                        id="Additional-info-tab"
                        data-bs-toggle="tab"
                        href="#Additional-info"
                        >Critères</a
                      >
                    </li>
                    <li class="nav-item">
                      <a
                        class="nav-link"
                        id="Vendor-info-tab"
                        data-bs-toggle="tab"
                        href="#Vendor-info"
                        >Vendeur</a
                      >
                    </li>
                  </ul>
                  <div class="tab-content shop_info_tab entry-main-content">
                    <div class="tab-pane fade show active" id="Description">
                      <div>
                        <p>
                          {{ adDetail.description }}
                        </p>
                        <hr class="wp-block-separator is-style-dots" />
                        <h5 class="mt-30">
                          <i class="fi fi-rr-region-pin-alt"></i>
                          {{ adDetail.city }}
                        </h5>
                        <!-- Google Maps Section -->
                        <div class="google-maps-container mt-30">
                          <app-google-map [city]="'Marrakech'"></app-google-map>
                        </div>
                      </div>
                    </div>

                    <div class="tab-pane fade" id="Additional-info">
                      <table class="font-md">
                        <tbody>
                          <tr
                            class="stand-up"
                            *ngFor="let field of transformedField"
                          >
                            <th>
                              <i
                                class="fi fi-rr-lightbulb-setting"
                                style="margin-right: 1rem"
                              ></i>
                              {{ field.label }}
                            </th>
                            <td>
                              <p *ngIf="field.type !== 'multiple'">
                                {{ field.setting }}
                              </p>
                              <ul
                                *ngIf="field.type === 'multiple'"
                                class="mylist"
                              >
                                <li *ngFor="let item of field.setting">
                                  {{ item }}
                                </li>
                              </ul>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <div class="tab-pane fade" id="Vendor-info">
                      <!--Comments-->
                      <div class="comments-area">
                        <div class="row">
                          <div class="col-lg-12">
                            <div class="comment-list">
                              <div
                                class="single-comment justify-content-between d-flex mb-30"
                              >
                                <div
                                  class="user justify-content-between d-flex"
                                >
                                  <div class="linksS">
                                    <div
                                      class="name-initials"
                                      style="
                                        display: flex;
                                        justify-content: center;
                                        align-items: center;
                                        background-color: #f0f0f0;
                                        border-radius: 50%;
                                        color: #3bb77e;
                                      "
                                    >
                                      {{ adDetail.user?.first_name?.slice(0, 1)
                                      }}{{
                                        adDetail.user?.last_name?.slice(0, 1)
                                      }}
                                    </div>
                                  </div>

                                  <div class="desc">
                                    <div
                                      class="d-flex justify-content-between mb-10"
                                    >
                                      <div class="d-flex align-items-center">
                                        <span class="font-xs text-muted">
                                          {{
                                            getFormattedDate(
                                              adDetail.created_at
                                            )
                                          }}
                                        </span>
                                      </div>
                                    </div>
                                    <h4 class="mb-10">
                                      {{ adDetail.user?.first_name }}
                                      {{ adDetail.user?.last_name }}
                                    </h4>
                                    <p
                                      class="mb-10"
                                      *ngIf="
                                        countsAds !== null &&
                                        (countsAds === 0 || countsAds === 1)
                                      "
                                    >
                                      {{ countsAds }} annonce
                                    </p>
                                    <p
                                      class="mb-10"
                                      *ngIf="
                                        countsAds !== null && countsAds > 1
                                      "
                                    >
                                      {{ countsAds }} annonces
                                    </p>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-60">
                <div class="col-12">
                  <h2 class="section-title style-1 mb-30">Annonces liées</h2>
                </div>

                <div class="col-12">
                  <div class="row">
                    <div
                      [ngClass]="{
                        'col-lg-3 col-md-4 col-12': !isScreenphone,
                        'col-6': isScreenphone
                      }"
                      *ngFor="let ad of relatedAds | slice : 0 : 4"
                    >
                      <div
                        class="product-cart-wrap mb-30 wow animate__animated animate__fadeIn"
                      >
                        <div class="product-img-action-wrap">
                          <div
                            class="product-img product-img-zoom"
                            style="height: 240px"
                          >
                            <a [href]="'/ads/' + ad.id" style="height: 100%">
                              <img
                                class="default-img"
                                [src]="ad.medias[0]?.url"
                                alt=""
                              />
                              <img
                                class="hover-img"
                                [src]="ad.medias[1]?.url || ad.medias[0]?.url"
                                alt=""
                                style="height: 100%"
                              />
                            </a>
                          </div>
                          <div class="product-action-1">
                            <a
                              aria-label="Ajouter à la liste de souhaits"
                              class="action-btn"
                              href="#"
                            >
                              <i class="fi-rs-heart"></i>
                            </a>
                          </div>
                        </div>
                        <div class="product-content-wrap">
                          <div
                            class="product-category"
                            style="margin-top: 1rem"
                          >
                            <a href="">{{ ad.category.name }}</a>
                          </div>
                          <h2>
                            <a href="">
                              {{ ad.title | slice : 0 : 17
                              }}{{ ad.title.length > 17 ? "..." : "" }}
                            </a>
                          </h2>
                          <div class="product-rate-cover">
                            <div
                              class=""
                              style="
                                width: 100%;
                                font-weight: 800;
                                font-size: medium;
                                color: black;
                              "
                            >
                              {{ ad.price }} DH
                            </div>
                          </div>
                          <div>
                            <span class="font-small text-muted">
                              {{ getRelativeTime(ad.created_at) }}
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div
            class="col-xl-4 primary-sidebar bottom mt-30"
            *ngIf="isScreenphone == true"
          >
            <!-- Acheter Button -->
            <!-- <a class="btn" href="/reserver" style="width: 100%; border-radius: 2rem">
                  <i class="fi fi-rr-cart-arrow-down"></i>
                  Acheter
                </a> -->

            <!-- Message Button -->
            <a
              class="btn"
              href="/chat/{{ adDetail.id }}"
              style="
                width: 100%;
                border-radius: 2rem;
                margin-top: 1rem;
                background: linear-gradient(45deg, #5ed0f2, #1d4ed8) !important;
              "
            >
              <i class="fi fi-rr-messages"></i>
              Contacter le vendeur
            </a>
          </div>
          <div
            class="col-xl-4 primary-sidebar mt-30"
            *ngIf="isScreenphone == false"
            [style.display]="isScreenphone ? 'none' : 'block'"
          >
            <div class="sidebar-widget widget-category-2 mb-30">
              <!--               <div class="social-links">
                <a href="#">
                  <img
                    style="width: 30px"
                    src="assets/imgs/theme/icons/category-1.svg"
                    alt=""
                    style="width: 35px"
                /></a>
              </div> -->

              <div class="social-links">
                <div
                  class="name-initials"
                  style="
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    background-color: #f0f0f0;
                    border-radius: 50%;
                    color: #3bb77e;
                  "
                >
                  {{ adDetail.user?.first_name?.slice(0, 1)
                  }}{{ adDetail.user?.last_name?.slice(0, 1) }}
                </div>
              </div>

              <h5 class="section-title style-1 mb-30">
                {{ adDetail.user?.first_name }} {{ adDetail.user?.last_name }}
                <p
                  class="mb-10"
                  *ngIf="
                    countsAds !== null && (countsAds === 0 || countsAds === 1)
                  "
                >
                  {{ countsAds }} annonce
                </p>
                <p class="mb-10" *ngIf="countsAds !== null && countsAds > 1">
                  {{ countsAds }} annonces
                </p>
              </h5>

              <ul>
                <a
                  class="btn"
                  href=""
                  style="
                    width: 100%;
                    border-radius: 2rem;
                    margin-top: 1rem;
                    background: linear-gradient(
                      45deg,
                      #5ed0f2,
                      #1d4ed8
                    ) !important;
                  "
                  [href]="'/chat/' + adDetail.id"
                  ><i class="fi fi-rr-messages"></i>
                  Message
                </a>
              </ul>
            </div>

            <!-- Fillter By Price -->

            <!-- Product sidebar Widget -->
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<app-footer></app-footer>

<app-preloader></app-preloader>
